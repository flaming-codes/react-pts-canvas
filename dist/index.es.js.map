{"version":3,"file":"index.es.js","sources":["../src/index.tsx"],"sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useEffect, useRef } from 'react'\nimport { CanvasSpace, Bound } from 'pts'\n\nexport class PtsCanvas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvRef = React.createRef();\n    this.space = null;\n    this.form = null;\n    this._touch = false;\n  }\n\n  componentDidMount() {\n    this.init();\n    this._update();\n  }\n\n  componentDidUpdate() {\n    this._update();\n  }\n\n  componentWillUnmount() {\n    this.space.dispose();\n  }\n\n  _update() {\n    if (this.props.play) {\n      this.space.play();\n    } else {\n      this.space.playOnce(0);\n    }\n\n    if (this._touch !== this.props.touch) {\n      this._touch = this.props.touch;\n      this.space.bindMouse( this._touch ).bindTouch( this._touch );\n    }\n  }\n\n\n  // Required: Override this to use Pts' player `animate` callback\n  // See guide: https://ptsjs.org/guide/space-0500\n  animate( time, ftime) {\n    this.form.point( this.space.pointer, 20, \"circle\" );\n  }\n\n  \n  // Optional: Override this to use Pts' player `start` callback\n  start( bound, space ) {}\n\n\n  // Optional: Override this to use Pts' player `resize` callback\n  resize( size, evt ) {}\n\n\n  // Optional: Override this to use Pts' player `action` callback\n  action ( type, px, py, evt ) {}\n\n\n  init() {\n    this.space = new CanvasSpace( this.canvRef ).setup({\n      bgcolor: this.props.background, \n      resize: this.props.resize, \n      retina: this.props.retina\n    });\n\n    this.form = this.space.getForm();\n    this.space.add( this );\n  }\n\n  render() {\n    return (\n      <div className={this.props.name || \"\"} style={this.props.style}>\n        <canvas className={this.props.name ? this.props.name+'-canvas' : ''} ref={c => (this.canvRef=c)} style={this.props.canvasStyle} />\n      </div>\n    );\n  }\n}\n\nPtsCanvas.defaultProps = {\n  name: \"pts-react\", // maps to className of the container div\n  background: \"#9ab\",\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {}\n} \n\nexport class QuickStartCanvas extends PtsCanvas {\n  \n  animate( time, ftime) {\n    if (this.props.onAnimate) this.props.onAnimate( this.space, this.form, time, ftime );\n  }\n\n  start( bound, space ) {\n    if (this.props.onStart) this.props.onStart( bound, space )\n  }\n\n  resize( size, evt ) {\n    if (this.props.onResize) this.props.onResize( this.space, this.form, size, evt );\n  }\n\n  action ( type, px, py, evt ) {\n    if (this.props.onAction) this.props.onAction( this.space, this.form, type, px, py, evt );\n  }\n\n}\n\n\nQuickStartCanvas.defaultProps = {\n  name: \"pts-react\", // maps to className of the container div\n  background: \"#9ab\",\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {},\n  onStart: undefined,\n  onAnimate: undefined,\n  onResize: undefined,\n  onAction: undefined\n}\n\n/**\n * Functional implementation of the PtsCanvas component\n * @param props\n */\nexport const PtsCanvasFC: React.FC<PtsCanvasFCProps> = (props) => {\n  const canvRef = props.canvRef || useRef(null)\n  const spaceRef = props.spaceRef || useRef(null)\n  const formRef = props.formRef || useRef(null)\n\n  /**\n   * When canvRef Updates (ready for space)\n   */\n  useEffect(() => {\n    // Create CanvasSpace with the canvRef and assign to spaceRef\n    // Add animation, tempo, and play when ready (call back on CanvasSpace constructor)\n    spaceRef.current = new CanvasSpace(canvRef.current).setup({\n      bgcolor: props.background,\n      resize: props.resize,\n      retina: props.retina\n    })\n\n    // Assign formRef\n    formRef.current = spaceRef.current.getForm()\n\n    // By having individual handler props, we can expose what we need to the\n    // underlying functions, like our Form instance\n    spaceRef.current.add({\n      start: (bound: Bound) => {\n        props.onStart &&\n          props.onStart(bound, spaceRef.current, formRef.current)\n      },\n      animate: (time: number, ftime: number) => {\n        props.onAnimate &&\n          props.onAnimate(spaceRef.current, formRef.current, time, ftime)\n      },\n      resize: (bound: Bound, event: Event) => { // eslint-disable-line no-undef\n        props.onResize &&\n          props.onResize(spaceRef.current, formRef.current, bound, event)\n      },\n      action: (type: string, px: number, py: number, evt: Event) => { // eslint-disable-line no-undef\n        props.onAction &&\n          props.onAction(\n            spaceRef.current,\n            formRef.current,\n            type,\n            px,\n            py,\n            evt\n          )\n      }\n    })\n\n    // Add tempo if provided\n    if (props.tempo) {\n      spaceRef.current.add(props.tempo)\n    }\n\n    // Return the cleanup function (similar to ComponentWillUnmount)\n    return () => {\n      spaceRef.current.dispose()\n    }\n  }, [canvRef])\n\n  /**\n   * When Touch updates\n   */\n  useEffect(() => {\n    spaceRef.current &&\n      spaceRef.current.bindMouse(props.touch).bindTouch(props.touch)\n  }, [props.touch])\n\n  /**\n   * When anything updates\n   */\n  useEffect(() => {\n    maybePlay()\n  })\n\n  /**\n   * Play or stop based on play prop\n   * */\n  const maybePlay = () => {\n    if (props.play) {\n      spaceRef.current && spaceRef.current.play()\n    } else {\n      spaceRef.current && spaceRef.current.playOnce(0)\n    }\n  }\n\n  return (\n    <div className={props.name || ''} style={props.style}>\n      <canvas\n        className={props.name ? props.name + '-canvas' : ''}\n        ref={canvRef}\n        style={props.canvasStyle}\n      />\n    </div>\n  )\n}\n\nPtsCanvasFC.defaultProps = {\n  name: 'pts-react', // maps to className of the container div\n  background: '#9ab',\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {},\n  onStart: undefined,\n  onAnimate: undefined,\n  onResize: undefined,\n  onAction: undefined,\n  tempo: null,\n  canvRef: null,\n  spaceRef: null,\n  formRef: null\n}\n"],"names":["PtsCanvas","props","canvRef","React","createRef","space","form","_touch","init","_update","dispose","play","playOnce","touch","bindMouse","bindTouch","time","ftime","point","pointer","bound","size","evt","type","px","py","CanvasSpace","setup","background","resize","retina","getForm","add","name","style","c","canvasStyle","Component","defaultProps","QuickStartCanvas","onAnimate","onStart","onResize","onAction","undefined","PtsCanvasFC","useRef","spaceRef","formRef","current","event","tempo","maybePlay"],"mappings":"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"}