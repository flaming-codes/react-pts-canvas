{"version":3,"file":"index.js","sources":["../src/legacy.tsx"],"sourcesContent":["/* eslint-disable react/prop-types */\nimport React from 'react'\nimport { CanvasSpace, CanvasForm, Bound, Group, IPlayer } from 'pts'\nimport { PtsCanvasLegacy, PtsCanvasLegacyProps, QuickStartProps } from './types'\n\nexport class PtsCanvas<T> extends React.Component<PtsCanvasLegacyProps & T> implements PtsCanvasLegacy<PtsCanvasLegacyProps & T> {\n  canvRef: React.RefObject<Element>\n  space: CanvasSpace | null\n  form: CanvasForm | null\n  _touch: boolean\n\n  defaultProps = {\n    name: 'pts-react', // maps to className of the container div\n    background: '#9ab',\n    resize: true,\n    retina: true,\n    play: true,\n    touch: true,\n    style: {},\n    canvasStyle: {}\n  }\n\n  constructor(props: T) {\n    super(props)\n    this.canvRef = React.createRef()\n    this.space = null\n    this.form = null\n    this._touch = false\n  }\n\n  componentDidMount() {\n    this.init()\n    this._update()\n  }\n\n  componentDidUpdate() {\n    this._update()\n  }\n\n  componentWillUnmount() {\n    if (!this.space) return\n    this.space.dispose()\n  }\n\n  _update() {\n    if (!this.space) return\n    if (this.props.play) {\n      this.space.play()\n    } else {\n      this.space.playOnce(0)\n    }\n\n    if (this._touch !== this.props.touch) {\n      this._touch = this.props.touch || false\n      this.space.bindMouse(this._touch).bindTouch(this._touch)\n    }\n  }\n\n  // Required: Override this to use Pts' player `animate` callback\n  // See guide: https://ptsjs.org/guide/space-0500\n  animate(time: number, ftime: number) {\n    if (!this.form || !this.space) return\n    this.form.point(this.space.pointer, 20, 'circle')\n  }\n\n  // Optional: Override this to use Pts' player `start` callback\n  start(bound: Bound, space: CanvasSpace) { console.log('Start callback') }\n\n  // Optional: Override this to use Pts' player `resize` callback\n  resize(size: Group, evt: Event) { console.log('Resize callback') }\n\n  // Optional: Override this to use Pts' player `action` callback\n  action(type: string, px: number, py: number, evt: Event) { console.log('Action callback') }\n\n  init() {\n    if (!this.canvRef.current) return\n    this.space = new CanvasSpace(this.canvRef.current).setup({\n      bgcolor: this.props.background,\n      resize: this.props.resize,\n      retina: this.props.retina\n    })\n\n    this.form = this.space.getForm()\n    this.space.add(this as IPlayer)\n  }\n\n  render() {\n    return (\n      <div className={this.props.name || ''} style={this.props.style}>\n        <canvas\n          className={this.props.name ? this.props.name + '-canvas' : ''}\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-ignore\n          ref={this.canvRef}\n          style={this.props.canvasStyle}\n        />\n      </div>\n    )\n  }\n}\n\nexport class QuickStartCanvas extends PtsCanvas<QuickStartProps> implements PtsCanvasLegacy<QuickStartProps> {\n  defaultProps = {\n    name: 'pts-react', // maps to className of the container div\n    background: '#9ab',\n    resize: true,\n    retina: true,\n    play: true,\n    touch: true,\n    style: {},\n    canvasStyle: {},\n    onStart: undefined,\n    onAnimate: undefined,\n    onResize: undefined,\n    onAction: undefined\n  }\n\n  override animate(time: number, ftime: number) {\n    if (!this.space || !this.form) return\n    if (this.props.onAnimate) {\n      this.props.onAnimate(this.space, this.form, time, ftime)\n    }\n  }\n\n  override start(bound: Bound, space: CanvasSpace) {\n    if (this.props.onStart) this.props.onStart(bound, space)\n  }\n\n  override resize(size: Group, evt: Event) {\n    if (this.props.onResize) {\n      this.props.onResize(this.space || undefined, this.form || undefined, size, evt)\n    }\n  }\n\n  override action(type: string, px: number, py: number, evt: Event) {\n    if (this.props.onAction) {\n      this.props.onAction(this.space || undefined, this.form || undefined, type, px, py, evt)\n    }\n  }\n}\n"],"names":["React","CanvasSpace"],"mappings":"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"}