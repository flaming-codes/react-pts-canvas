{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useEffect, useRef } from 'react'\nimport { CanvasSpace, Bound } from 'pts'\nimport type { PtsCanvasProps } from './types'\n\nexport const PtsCanvas: React.FC<PtsCanvasProps> = (props) => {\n  const canvRef = useRef(null)\n  const spaceRef = useRef(null)\n  const formRef = useRef(null)\n\n  /**\n   * When canvRef Updates (ready for space)\n   */\n  useEffect(() => {\n    // Create CanvasSpace with the canvRef and assign to spaceRef\n    // Add animation, tempo, and play when ready (call back on CanvasSpace constructor)\n    spaceRef.current = new CanvasSpace(canvRef.current).setup({\n      bgcolor: props.background,\n      resize: props.resize,\n      retina: props.retina\n    })\n\n    // Assign formRef\n    formRef.current = spaceRef.current.getForm()\n\n    // By having individual handler props, we can expose what we need to the\n    // underlying functions, like our Form instance\n    spaceRef.current.add({\n      start: (bound: Bound) => {\n        props.onStart &&\n          props.onStart(bound, spaceRef.current, formRef.current)\n      },\n      animate: (time: number, ftime: number) => {\n        props.onAnimate &&\n          props.onAnimate(spaceRef.current, formRef.current, time, ftime)\n      },\n      resize: (bound: Bound, event: Event) => { // eslint-disable-line no-undef\n        props.onResize &&\n          props.onResize(spaceRef.current, formRef.current, bound, event)\n      },\n      action: (type: string, px: number, py: number, evt: Event) => { // eslint-disable-line no-undef\n        props.onAction &&\n          props.onAction(\n            spaceRef.current,\n            formRef.current,\n            type,\n            px,\n            py,\n            evt\n          )\n      }\n    })\n\n    // Add tempo if provided\n    if (props.tempo) {\n      spaceRef.current.add(props.tempo)\n    }\n\n    // Return the cleanup function (similar to ComponentWillUnmount)\n    return () => {\n      spaceRef.current.dispose()\n    }\n  }, [canvRef])\n\n  /**\n   * When Touch updates\n   */\n  useEffect(() => {\n    spaceRef.current &&\n      spaceRef.current.bindMouse(props.touch).bindTouch(props.touch)\n  }, [props.touch])\n\n  /**\n   * When anything updates\n   */\n  useEffect(() => {\n    maybePlay()\n  })\n\n  /**\n   * Play or stop based on play prop\n   * */\n  const maybePlay = () => {\n    if (props.play) {\n      spaceRef.current && spaceRef.current.play()\n    } else {\n      spaceRef.current && spaceRef.current.playOnce(0)\n    }\n  }\n\n  return (\n    <div className={props.name || ''} style={props.style}>\n      <canvas\n        className={props.name ? props.name + '-canvas' : ''}\n        ref={canvRef}\n        style={props.canvasStyle}\n      />\n    </div>\n  )\n}\n\nPtsCanvas.defaultProps = {\n  name: 'pts-react', // maps to className of the container div\n  background: '#9ab',\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {},\n  onStart: undefined,\n  onAnimate: undefined,\n  onResize: undefined,\n  onAction: undefined\n}\n"],"names":["PtsCanvas","props","canvRef","useRef","spaceRef","formRef","current","CanvasSpace","setup","background","resize","retina","getForm","add","bound","onStart","time","ftime","onAnimate","event","onResize","type","px","py","evt","onAction","tempo","dispose","bindMouse","touch","bindTouch","maybePlay","play","playOnce","React","name","style","canvasStyle","defaultProps","undefined"],"mappings":";;;;;;;;;;AAAA;AACA;;AAIA,IAAaA,YAAsC,SAAtCA,SAAsC,CAACC,KAAD,EAAW;MACtDC,UAAUC,aAAO,IAAP,CAAhB;MACMC,WAAWD,aAAO,IAAP,CAAjB;MACME,UAAUF,aAAO,IAAP,CAAhB;;;;;kBAKU,YAAM;;;aAGLG,OAAT,GAAmB,IAAIC,eAAJ,CAAgBL,QAAQI,OAAxB,EAAiCE,KAAjC,CAAuC;eAC/CP,MAAMQ,UADyC;cAEhDR,MAAMS,MAF0C;cAGhDT,MAAMU;KAHG,CAAnB;;;YAOQL,OAAR,GAAkBF,SAASE,OAAT,CAAiBM,OAAjB,EAAlB;;;;aAISN,OAAT,CAAiBO,GAAjB,CAAqB;aACZ,eAACC,KAAD,EAAkB;cACjBC,OAAN,IACEd,MAAMc,OAAN,CAAcD,KAAd,EAAqBV,SAASE,OAA9B,EAAuCD,QAAQC,OAA/C,CADF;OAFiB;eAKV,iBAACU,IAAD,EAAeC,KAAf,EAAiC;cAClCC,SAAN,IACEjB,MAAMiB,SAAN,CAAgBd,SAASE,OAAzB,EAAkCD,QAAQC,OAA1C,EAAmDU,IAAnD,EAAyDC,KAAzD,CADF;OANiB;cASX,gBAACH,KAAD,EAAeK,KAAf,EAAgC;;cAChCC,QAAN,IACEnB,MAAMmB,QAAN,CAAehB,SAASE,OAAxB,EAAiCD,QAAQC,OAAzC,EAAkDQ,KAAlD,EAAyDK,KAAzD,CADF;OAViB;cAaX,gBAACE,IAAD,EAAeC,EAAf,EAA2BC,EAA3B,EAAuCC,GAAvC,EAAsD;;cACtDC,QAAN,IACExB,MAAMwB,QAAN,CACErB,SAASE,OADX,EAEED,QAAQC,OAFV,EAGEe,IAHF,EAIEC,EAJF,EAKEC,EALF,EAMEC,GANF,CADF;;KAdJ;;;QA2BIvB,MAAMyB,KAAV,EAAiB;eACNpB,OAAT,CAAiBO,GAAjB,CAAqBZ,MAAMyB,KAA3B;;;;WAIK,YAAM;eACFpB,OAAT,CAAiBqB,OAAjB;KADF;GA9CF,EAiDG,CAACzB,OAAD,CAjDH;;;;;kBAsDU,YAAM;aACLI,OAAT,IACEF,SAASE,OAAT,CAAiBsB,SAAjB,CAA2B3B,MAAM4B,KAAjC,EAAwCC,SAAxC,CAAkD7B,MAAM4B,KAAxD,CADF;GADF,EAGG,CAAC5B,MAAM4B,KAAP,CAHH;;;;;kBAQU,YAAM;;GAAhB;;;;;MAOME,YAAY,SAAZA,SAAY,GAAM;QAClB9B,MAAM+B,IAAV,EAAgB;eACL1B,OAAT,IAAoBF,SAASE,OAAT,CAAiB0B,IAAjB,EAApB;KADF,MAEO;eACI1B,OAAT,IAAoBF,SAASE,OAAT,CAAiB2B,QAAjB,CAA0B,CAA1B,CAApB;;GAJJ;;SASEC;;MAAK,WAAWjC,MAAMkC,IAAN,IAAc,EAA9B,EAAkC,OAAOlC,MAAMmC,KAA/C;;iBAEenC,MAAMkC,IAAN,GAAalC,MAAMkC,IAAN,GAAa,SAA1B,GAAsC,EADnD;WAEOjC,OAFP;aAGSD,MAAMoC;;GALnB;CArFK;;AAgGPrC,UAAUsC,YAAV,GAAyB;QACjB,WADiB;cAEX,MAFW;UAGf,IAHe;UAIf,IAJe;QAKjB,IALiB;SAMhB,IANgB;SAOhB,EAPgB;eAQV,EARU;WASdC,SATc;aAUZA,SAVY;YAWbA,SAXa;YAYbA;CAZZ;;;;"}