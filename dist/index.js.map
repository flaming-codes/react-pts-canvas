{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["/* eslint-disable react/prop-types */\nimport React, { useEffect, useRef } from 'react'\nimport { CanvasSpace, Bound } from 'pts'\n\nexport class PtsCanvas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvRef = React.createRef();\n    this.space = null;\n    this.form = null;\n    this._touch = false;\n  }\n\n  componentDidMount() {\n    this.init();\n    this._update();\n  }\n\n  componentDidUpdate() {\n    this._update();\n  }\n\n  componentWillUnmount() {\n    this.space.dispose();\n  }\n\n  _update() {\n    if (this.props.play) {\n      this.space.play();\n    } else {\n      this.space.playOnce(0);\n    }\n\n    if (this._touch !== this.props.touch) {\n      this._touch = this.props.touch;\n      this.space.bindMouse( this._touch ).bindTouch( this._touch );\n    }\n  }\n\n\n  // Required: Override this to use Pts' player `animate` callback\n  // See guide: https://ptsjs.org/guide/space-0500\n  animate( time, ftime) {\n    this.form.point( this.space.pointer, 20, \"circle\" );\n  }\n\n  \n  // Optional: Override this to use Pts' player `start` callback\n  start( bound, space ) {}\n\n\n  // Optional: Override this to use Pts' player `resize` callback\n  resize( size, evt ) {}\n\n\n  // Optional: Override this to use Pts' player `action` callback\n  action ( type, px, py, evt ) {}\n\n\n  init() {\n    this.space = new CanvasSpace( this.canvRef ).setup({\n      bgcolor: this.props.background, \n      resize: this.props.resize, \n      retina: this.props.retina\n    });\n\n    this.form = this.space.getForm();\n    this.space.add( this );\n  }\n\n  render() {\n    return (\n      <div className={this.props.name || \"\"} style={this.props.style}>\n        <canvas className={this.props.name ? this.props.name+'-canvas' : ''} ref={c => (this.canvRef=c)} style={this.props.canvasStyle} />\n      </div>\n    );\n  }\n}\n\nPtsCanvas.defaultProps = {\n  name: \"pts-react\", // maps to className of the container div\n  background: \"#9ab\",\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {}\n} \n\nexport class QuickStartCanvas extends PtsCanvas {\n  \n  animate( time, ftime) {\n    if (this.props.onAnimate) this.props.onAnimate( this.space, this.form, time, ftime );\n  }\n\n  start( bound, space ) {\n    if (this.props.onStart) this.props.onStart( bound, space )\n  }\n\n  resize( size, evt ) {\n    if (this.props.onResize) this.props.onResize( this.space, this.form, size, evt );\n  }\n\n  action ( type, px, py, evt ) {\n    if (this.props.onAction) this.props.onAction( this.space, this.form, type, px, py, evt );\n  }\n\n}\n\n\nQuickStartCanvas.defaultProps = {\n  name: \"pts-react\", // maps to className of the container div\n  background: \"#9ab\",\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {},\n  onStart: undefined,\n  onAnimate: undefined,\n  onResize: undefined,\n  onAction: undefined\n}\n\n/**\n * Functional implementation of the PtsCanvas component\n * @param props\n */\nexport const PtsCanvasFC: React.FC<PtsCanvasFCProps> = (props) => {\n  const canvRef = props.canvRef || useRef(null)\n  const spaceRef = props.spaceRef || useRef(null)\n  const formRef = props.formRef || useRef(null)\n\n  /**\n   * When canvRef Updates (ready for space)\n   */\n  useEffect(() => {\n    // Create CanvasSpace with the canvRef and assign to spaceRef\n    // Add animation, tempo, and play when ready (call back on CanvasSpace constructor)\n    spaceRef.current = new CanvasSpace(canvRef.current).setup({\n      bgcolor: props.background,\n      resize: props.resize,\n      retina: props.retina\n    })\n\n    // Assign formRef\n    formRef.current = spaceRef.current.getForm()\n\n    // By having individual handler props, we can expose what we need to the\n    // underlying functions, like our Form instance\n    spaceRef.current.add({\n      start: (bound: Bound) => {\n        props.onStart &&\n          props.onStart(bound, spaceRef.current, formRef.current)\n      },\n      animate: (time: number, ftime: number) => {\n        props.onAnimate &&\n          props.onAnimate(spaceRef.current, formRef.current, time, ftime)\n      },\n      resize: (bound: Bound, event: Event) => { // eslint-disable-line no-undef\n        props.onResize &&\n          props.onResize(spaceRef.current, formRef.current, bound, event)\n      },\n      action: (type: string, px: number, py: number, evt: Event) => { // eslint-disable-line no-undef\n        props.onAction &&\n          props.onAction(\n            spaceRef.current,\n            formRef.current,\n            type,\n            px,\n            py,\n            evt\n          )\n      }\n    })\n\n    // Add tempo if provided\n    if (props.tempo) {\n      spaceRef.current.add(props.tempo)\n    }\n\n    // Return the cleanup function (similar to ComponentWillUnmount)\n    return () => {\n      spaceRef.current.dispose()\n    }\n  }, [canvRef])\n\n  /**\n   * When Touch updates\n   */\n  useEffect(() => {\n    spaceRef.current &&\n      spaceRef.current.bindMouse(props.touch).bindTouch(props.touch)\n  }, [props.touch])\n\n  /**\n   * When anything updates\n   */\n  useEffect(() => {\n    maybePlay()\n  })\n\n  /**\n   * Play or stop based on play prop\n   * */\n  const maybePlay = () => {\n    if (props.play) {\n      spaceRef.current && spaceRef.current.play()\n    } else {\n      spaceRef.current && spaceRef.current.playOnce(0)\n    }\n  }\n\n  return (\n    <div className={props.name || ''} style={props.style}>\n      <canvas\n        className={props.name ? props.name + '-canvas' : ''}\n        ref={canvRef}\n        style={props.canvasStyle}\n      />\n    </div>\n  )\n}\n\nPtsCanvasFC.defaultProps = {\n  name: 'pts-react', // maps to className of the container div\n  background: '#9ab',\n  resize: true,\n  retina: true,\n  play: true,\n  touch: true,\n  style: {},\n  canvasStyle: {},\n  onStart: undefined,\n  onAnimate: undefined,\n  onResize: undefined,\n  onAction: undefined,\n  tempo: null,\n  canvRef: null,\n  spaceRef: null,\n  formRef: null\n}\n"],"names":["PtsCanvas","props","canvRef","react_1","createRef","space","form","_touch","init","_update","dispose","play","playOnce","touch","bindMouse","bindTouch","time","ftime","point","pointer","bound","size","evt","type","px","py","pts_1","setup","bgcolor","background","resize","retina","getForm","add","className","name","style","ref","c","canvasStyle","Component","exports","defaultProps","QuickStartCanvas","onAnimate","onStart","onResize","onAction","undefined","PtsCanvasFC","spaceRef","formRef","current","start","animate","event","action","tempo","maybePlay"],"mappings":"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"}